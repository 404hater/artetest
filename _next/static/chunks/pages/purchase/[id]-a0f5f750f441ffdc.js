(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{5797:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/purchase/[id]",function(){return a(8514)}])},8297:function(e,t,a){"use strict";var n=a(5893),o=a(7294),l=a(3979),s=a.n(l);let i=e=>{let{label:t,checked:a=!1,onChange:l,disabled:i,buttonPos:r="left",style:c,className:d}=e,[u,p]=(0,o.useState)(a);return(0,n.jsxs)("label",{className:"checkbox".concat(u?" checked":"").concat(d?" ".concat(d):""," ").concat(s().checkbox),style:c,children:["right"===r&&t&&t,(0,n.jsx)("input",{type:"checkbox",checked:u,onChange(e){l&&l(e.target.checked),p(!a)},disabled:i}),(0,n.jsx)("i",{className:"btn ".concat(s().btn)}),(0,n.jsx)("span",{className:s().labelText,children:"left"===r&&t&&t})]})};t.Z=i},9441:function(e,t,a){"use strict";var n=a(5893),o=a(7294),l=a(7329),s=a.n(l),i=a(6595);let r=e=>{let{options:t,style:a,value:l,onChange:r,className:c}=e,[d,u]=(0,o.useState)(!1);return(0,i.g)(".select",u),(0,n.jsxs)("div",{className:"select ".concat(s().customSelect).concat(d?" ".concat(s().active," active"):"").concat(c?" ".concat(c):""),style:a,children:[(0,n.jsx)("button",{onClick(){d?u(!1):u(!0)},children:null==t?void 0:t.map(e=>l?e.value===l?e.name:void 0:"")}),d&&(0,n.jsx)("ul",{children:null==t?void 0:t.map((e,t)=>(0,n.jsx)("li",{children:(0,n.jsx)("button",{className:e.value===l?"selected ".concat(s().selected):"",onClick(){r&&e.value&&r(e.value),u(!1)},children:e.name})},"selectOption".concat(e.value).concat(t)))})]})};t.Z=r},8589:function(e,t,a){"use strict";var n=a(5893);a(7294);var o=a(7815),l=a.n(o);let s=e=>{let{label:t,checked:a,onChange:o,disabled:s=!1,buttonPos:i="left",style:r,className:c}=e;return(0,n.jsxs)("label",{className:"radio".concat(a?" checked":"").concat(c?" ".concat(c):""," ").concat(l().radio),style:r,children:["right"===i&&t&&t,(0,n.jsx)("input",{type:"radio",checked:a,onChange(e){o&&o(e.target.checked)},disabled:s}),(0,n.jsx)("i",{className:"btn ".concat(l().btn)}),(0,n.jsx)("span",{className:l().labelText,children:"left"===i&&t&&t})]})};t.Z=s},9487:function(e,t,a){"use strict";var n=a(5893);a(7294);var o=a(9418),l=a.n(o);let s=e=>{let{info:t}=e;return(0,n.jsx)("div",{className:"goodsInfo ".concat(l().goodsInfo),children:null==t?void 0:t.map(e=>{var t;return(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{children:e.title}),(0,n.jsx)("dd",{children:(0,n.jsx)("ul",{children:null===(t=e.content)||void 0===t?void 0:t.map(e=>{if(e.value)return(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:e.name}),e.value]},e.name)})})})]},e.title)})})};t.Z=s},7172:function(e,t,a){"use strict";var n=a(5893);a(7294);var o=a(9441),l=a(6670);let s=(0,l.Pi)(e=>{let{option:t,value:a,onChange:l,style:s}=e;return(0,n.jsx)("div",{className:"inputCoupon",style:s,children:(0,n.jsx)(o.Z,{options:t,value:a,onChange(e){l&&l(e)},className:"-1"===a?"gray":""})})});t.Z=s},4812:function(e,t,a){"use strict";var n=a(5893),o=a(7294),l=a(7753),s=a(8589),i=a(6434),r=a.n(i),c=a(8490),d=a(6670),u=a(1163);let p=(0,d.Pi)(e=>{var t,a;let{language:i}=e,{purchaseStore:d}=(0,l.Yh)(),p=(0,u.useRouter)(),h=(0,o.useCallback)((e,t)=>{switch(e){case"eth":case"kakao":case"pg":return c.y0.X_[e][t]}},[i]);return(0,o.useEffect)(()=>{p.asPath.indexOf("poster")>-1&&d.setPaymentMethod("kakao")},[p.isReady]),(0,n.jsxs)("dl",{className:"paymentMethod ".concat(r().paymentMethod),children:[(0,n.jsx)("dt",{children:c.CL.lA.mG[i]}),(0,n.jsx)("dd",{children:d.paymentMethods&&(null===(a=null===(t=d.paymentMethods)||void 0===t?void 0:t.filter(e=>p.asPath.indexOf("poster")>-1?"kakao"===e.name:p.asPath.indexOf("order")>-1?"pg"===e.name:"eth"===e.name||"pg"===e.name))||void 0===a?void 0:a.map(e=>(0,n.jsx)(s.Z,{label:h(e.name,i),checked:e.checked,buttonPos:"right",onChange(){d.setPaymentMethod(e.name)}},e.name)))})]})});t.Z=p},4957:function(e,t,a){"use strict";var n=a(5893);a(7294);var o=a(4032),l=a.n(o);let s=e=>{let{imgSrc:t,goodsInfo:a,className:o,fileExt:s}=e;return(0,n.jsxs)("div",{className:"purchaseTop".concat(o?" ".concat(o):""," ").concat(l().purchaseTop),children:[(0,n.jsx)("div",{className:"imgArea",children:"mp4"===s||t&&".mp4".indexOf(t.slice(-4))>-1?(0,n.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:(0,n.jsx)("source",{src:t})},t):(0,n.jsx)("div",{className:"imgAreaInner",style:{backgroundImage:"url(".concat(t,")")}})}),(0,n.jsx)("div",{className:"rightSide",children:a})]})};t.Z=s},3826:function(e,t,a){"use strict";var n=a(7294);let o=e=>{(0,n.useEffect)(()=>()=>{e.init()},[])};t.Z=o},5873:function(e,t,a){"use strict";a.d(t,{w:function(){return o}});var n=a(7294);let o=e=>{(0,n.useEffect)(()=>{let t=document.querySelector(".wrap > .header"),a=document.querySelector(".wrap > .container");if(e){let n=document.querySelector(e);n.style.paddingTop=t.clientHeight+"px"}else a.style.paddingTop=t.clientHeight+"px"},[])}},8514:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return A}});var n=a(5893),o=a(7294),l=a(9858),s=a(4957),i=a(8002),r=a.n(i),c=a(5873),d=a(9487),u=a(7753);let p=()=>{var e,t,a,o;let{purchaseStore:l}=(0,u.Yh)();return(0,n.jsx)("div",{className:"priceInfo",children:(0,n.jsxs)("div",{className:"prices",children:[(0,n.jsx)("p",{children:Number(l.selectedUserCoupon.value)>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("del",{children:[null===(e=l.data)||void 0===e?void 0:e.product.cryptoPrice.toLocaleString(),(0,n.jsx)("span",{className:"unit",children:"ETH"})]}),(0,n.jsxs)("span",{className:"discount",children:[null===(t=l.paymentRequest.ethPrice)||void 0===t?void 0:t.toLocaleString(),(0,n.jsx)("span",{className:"unit",children:"ETH"})]})]}):(0,n.jsxs)(n.Fragment,{children:[null===(a=l.data)||void 0===a?void 0:a.product.cryptoPrice.toLocaleString(),(0,n.jsx)("span",{className:"unit",children:"ETH"})]})}),(0,n.jsxs)("p",{children:[null===(o=l.data)||void 0===o?void 0:o.product.wonPrice.toLocaleString(),(0,n.jsx)("span",{className:"unit",children:"WON"})]})]})})};var h=a(4812),m=a(7172),x=a(8297),v=a(7611),g=a(6670),f=a(8490);let j=(0,g.Pi)(e=>{let{language:t,onChange:a,checked:l}=e,[s,i]=(0,o.useState)(!1);return(0,n.jsxs)("div",{className:"rulesConfirm",children:["ko"===t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>i(!0),children:f.e_.Ri._x[t]}),f.e_.Ri.Nn[t],f.e_.Ri.eE[t]]}):"en"===t?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(n.Fragment,{children:[f.e_.Ri.Nn[t],"\xa0",(0,n.jsx)("button",{onClick:()=>i(!0),children:f.e_.Ri._x[t]}),"\xa0",f.e_.Ri.eE[t]]})}):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)("sup",{children:"*"}),(0,n.jsx)(x.Z,{checked:l,onChange:e=>a&&a(e)}),s&&(0,n.jsx)(v.Z,{type:"terms",close:()=>i(!1),language:t})]})});var y=a(3313),N=a(283),_=a(5462),S=a(1163);let k=e=>{let{mode:t,title:a,content:o,close:l,closable:s=!0,textOk:i,textNo:r,onOk:c,onNo:d}=e;return(0,n.jsx)("div",{className:"dim",children:(0,n.jsxs)("div",{className:"dialog ".concat(t),children:[a&&(0,n.jsx)("h1",{className:"dialogTitle",children:a}),(0,n.jsx)("div",{className:"dialogContents",children:o}),(0,n.jsxs)("div",{className:"dialogFooter",children:["confirm"===t&&(0,n.jsx)("button",{className:"cancel",onClick:()=>(l&&l(!1),d&&d(),"CANCEL"),children:r||"취소"}),(0,n.jsx)("button",{className:"ok",onClick:()=>(l&&l(!1),c&&c(),"OK"),children:i||"확인"})]}),s&&(0,n.jsx)("button",{onClick:()=>(l&&l(!1),"CLOSE"),className:"dialogClose"})]})})},w=e=>{let{title:t,content:a,close:o,textOk:l,onOk:s}=e;return(0,n.jsx)(k,{mode:"alert",title:t,content:a,close(e){o&&o(e)},textOk:l,onOk:()=>s&&s()})};var b=a(786),C=a(9916),E=a(1438),T=a(4146);let I=[{inputs:[{internalType:"string",name:"tokenURI",type:"string"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"address",name:"account",type:"address"},{internalType:"bool",name:"cbt",type:"bool"}],name:"mintToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"payable",type:"function"}];var O=a(6371),P=a(3826),R=a(3550);let Z=(0,g.Pi)(()=>{var e,t,a,i,u,x,v,g,k,Z,A,q,F,M,L,z,H,D,W,Q,U,X;let{purchaseStore:K,commonStore:B}=(0,y.o)(),J=(0,_.Z)();(0,c.w)(".containerInner");let G=(0,N.X)(),Y=(0,S.useRouter)();(0,P.Z)(K),(0,o.useEffect)(()=>{Y.isReady&&Y.query.id&&B.activate&&(K.setErrorState(""),K.load(Y.query.id.toString(),Y.query.salesType?Y.query.salesType:"OS",!!Y.query.address).then()),B.activate||K.setErrorState("wallet")},[B.activate]),(0,o.useEffect)(()=>{K.userCouponList=K.userCouponList.map(e=>"-1"===e.value?{...e,name:f.e_.mH[J]}:{...e})},[J]);let V="".concat("https://dstrict.s3.amazonaws.com/artenft").concat((null===(e=K.data)||void 0===e?void 0:e.product.previewFilePath)&&(null===(t=K.data)||void 0===t?void 0:t.product.previewFileName)?null===(a=K.data)||void 0===a?void 0:a.product.previewFilePath:null===(i=K.data)||void 0===i?void 0:i.product.thumbFilePath).concat((null===(u=K.data)||void 0===u?void 0:u.product.previewFilePath)&&(null===(x=K.data)||void 0===x?void 0:x.product.previewFileName)?null===(v=K.data)||void 0===v?void 0:v.product.previewFileName:null===(g=K.data)||void 0===g?void 0:g.product.thumbFileName),$=async()=>{try{var e,t,a;let n=new E.Qg(window.ethereum);if(null===(e=B.userInfo)||void 0===e||!e.walletAddress)return!1;{console.log(null===(t=B.userInfo)||void 0===t?void 0:t.walletAddress);let o=await n.getBalance(null===(a=B.userInfo)||void 0===a?void 0:a.walletAddress),l=(0,C.Z8)(o._hex.toString().slice(2));if(console.log(l),l<.055)return K.setErrorState("balance"),!1;return!0}}catch(s){console.log(JSON.stringify(s)),await Y.push("/error")}},ee=async()=>{try{var e,t;let{ethereum:a}=window,n=new E.Qg(a),o=await K.fetchEtherReady(),l=localStorage.getItem("orderId");if(console.log(l),n&&o&&l&&(null===(e=B.userInfo)||void 0===e?void 0:e.walletAddress)&&K.paymentRequest.ethPrice&&(null===(t=K.data)||void 0===t?void 0:t.product.tokenUri)){let s="0xf83636F4fC9325A230c607D44C722974f2335e3b",i=n.getSigner(B.userInfo.walletAddress);if(i&&s){let r=new T.CH(s,I,i),c=(0,O.parseEther)(K.paymentRequest.ethPrice.toString()),d=await r.populateTransaction.mintToken(K.data.product.tokenUri,c,B.userInfo.walletAddress,!1,{value:c}),u=await i.sendTransaction({...d,gasLimit:42e3}),{hash:p}=u;await K.fetchEtherResult(Number(l),p)}else await Y.push("/error")}}catch(m){console.log(m);let h=localStorage.getItem("orderId");h&&await K.fetchEtherResult(Number(h)),m.message.includes("Not enough ethers")?K.setErrorState("balance"):await Y.push("/error")}finally{localStorage.removeItem("orderId"),localStorage.removeItem("salesType")}};return(0,n.jsx)(l.Z,{bg:"white",headerBg:"white",children:(0,n.jsxs)("div",{className:"posterWrap ".concat(r().posterWrap),children:[(0,n.jsx)(s.Z,{imgSrc:V,fileExt:null===(k=K.data)||void 0===k?void 0:k.product.properties.fileExtension,goodsInfo:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("strong",{className:"goodsName",children:null===(Z=K.data)||void 0===Z?void 0:Z.product.editionName}),(0,n.jsx)("p",{className:"editionInfo",children:K.isEdition?"Edition ".concat(null===(A=K.data)||void 0===A?void 0:A.product.currEdition," of ").concat(null===(q=K.data)||void 0===q?void 0:q.product.totalEdition):null===(F=K.data)||void 0===F?void 0:F.product.editionNumber}),(0,n.jsx)(d.Z,{info:[{title:"PROPERTIES",content:K.isEdition?[{name:"DIMENSION",value:null===(M=K.data)||void 0===M?void 0:M.product.properties.dimension},{name:"FILE EXTENSION",value:null===(L=K.data)||void 0===L?void 0:L.product.properties.fileExtension}]:[{name:"PROPORTION",value:null===(z=K.data)||void 0===z?void 0:z.product.properties.ratio},{name:"SIZE OPTION",value:null===(H=K.data)||void 0===H?void 0:H.product.properties.size},{name:"DIMENSION",value:null===(D=K.data)||void 0===D?void 0:D.product.properties.dimension},{name:"FILE EXTENSION",value:null===(W=K.data)||void 0===W?void 0:W.product.properties.fileExtension}]},{title:"DETAILS",content:[{name:"CONTRACT ADDRESS",value:(0,C.Hp)(null!==(X=null===(Q=K.data)||void 0===Q?void 0:Q.product.details.contractAddr)&&void 0!==X?X:"")},{name:"BLOCKCHAIN",value:null===(U=K.data)||void 0===U?void 0:U.product.details.blockchain}]}]}),(0,n.jsx)(p,{}),(0,n.jsx)(h.Z,{language:J}),K.userCouponList.length>1&&(0,n.jsx)(m.Z,{option:K.userCouponList,value:K.selectedUserCoupon.value,onChange:e=>K.setSelectedUserCoupon(e)}),(0,n.jsx)(j,{language:J,checked:K.agree,onChange:e=>K.setAgree(e)}),(0,n.jsx)("button",{className:"blackButton",async onClick(){if("OS"===Y.query.salesType){if("eth"===K.selectedPaymentMethod||!K.agree){K.setAllowModal(!0);return}if("pg"===K.selectedPaymentMethod){await K.fetchWonReady(null!=G&&G);return}await K.fetchKaKaoReady(null!=G&&G)}else alert(f.y0.ZI[J])},children:f.CL.c6[J]}),G&&(0,n.jsx)("p",{className:"paymentWarn",children:"통화로 결제시 이더리움 변동에 따라 실 결제금액에 차이가 있을 수 있습니다."})]})}),K.allowModal&&"agree"===K.modalType&&(0,n.jsx)(w,{content:(0,n.jsx)("p",{style:{width:"210px",marginTop:"20px",fontSize:"15px",color:"#000"},children:f.e_.xn.f[J]}),textOk:f.e_.xn.q[J],close(e){K.setAllowModal(e)}}),K.allowModal&&"eth"===K.modalType&&(0,n.jsx)(w,{title:(0,n.jsxs)("strong",{style:{display:"flex",alignItems:"center",fontSize:"32px"},children:[(0,n.jsx)("img",{src:"/images/common/icon_exclamation.svg",alt:"",style:{marginRight:"20px"}}),f.e_.qC.TN[J]]}),content:(0,n.jsx)("p",{style:{width:"370px",marginTop:"20px",fontSize:"14px",color:"#666"},children:(0,b.Z)(f.e_.qC.kQ[J],"etherAlert")}),close(e){K.setAllowModal(e)},textOk:f.e_.qC.q5[J],async onOk(){let e=await $();e&&await ee()}}),"reserved"===K.errorState&&(0,n.jsx)(w,{title:(0,n.jsxs)("strong",{style:{display:"flex",alignItems:"center",fontSize:"32px"},children:[(0,n.jsx)("img",{src:"/images/common/icon_exclamation.svg",alt:"",style:{marginRight:"20px"}}),f.e_.Jm.TN[J]]}),content:(0,n.jsx)("p",{style:{width:"370px",marginTop:"20px",fontSize:"14px",color:"#666"},children:(0,b.Z)(f.e_.Jm.kQ[J],"etherAlert")}),close(){K.setErrorState(""),Y.back()},textOk:f.e_.Jm.q5[J],onOk(){K.setErrorState(""),Y.back()}}),"balance"===K.errorState&&(0,n.jsx)(w,{title:(0,n.jsxs)("strong",{style:{display:"flex",alignItems:"center",fontSize:"32px"},children:[(0,n.jsx)("img",{src:"/images/common/icon_exclamation.svg",alt:"",style:{marginRight:"20px"}}),f.e_.e9.TN[J]]}),content:(0,n.jsx)("p",{style:{width:"370px",marginTop:"20px",fontSize:"14px",color:"#666"},children:(0,b.Z)(f.e_.e9.kQ[J],"etherAlert")}),close(){K.setErrorState("")},textOk:f.e_.e9.q5[J],onOk(){K.setErrorState("")}}),"wallet"===K.errorState&&(0,n.jsx)(R.default,{onClose:()=>K.setErrorState("")})]})})});var A=Z},3979:function(e){e.exports={checkbox:"Checkbox_checkbox__fD2HK",btn:"Checkbox_btn__Gx6rC"}},7329:function(e){e.exports={customSelect:"CustomSelect_customSelect__T_cIl",active:"CustomSelect_active__WFowY",selected:"CustomSelect_selected__s8ZIa"}},7815:function(e){e.exports={radio:"Radio_radio__04TQC",btn:"Radio_btn__u_q18"}},9418:function(e){e.exports={goodsInfo:"GoodsInfo_goodsInfo__0Qn7T"}},6434:function(e){e.exports={paymentMethod:"PaymentMthod_paymentMethod__zrOOZ"}},4032:function(e){e.exports={purchaseTop:"PurchaseTop_purchaseTop__3lUbh"}},8002:function(e){e.exports={posterWrap:"Purchase_posterWrap__x3DNp"}}},function(e){e.O(0,[664,548,858,774,888,179],function(){return e(e.s=5797)}),_N_E=e.O()}]);